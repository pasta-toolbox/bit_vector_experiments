% -*- mode: latex; mode: flyspell; ispell-local-dictionary: "en_US"; coding: utf-8 -*-
\documentclass[a4paper,UKenglish,cleveref, autoref, thm-restate]{lipics-v2021}
%This is a template for producing LIPIcs articles. 
%See lipics-v2021-authors-guidelines.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
%for section-numbered lemmas etc., use "numberwithinsect"
%for enabling cleveref support, use "cleveref"
%for enabling autoref support, use "autoref"
%for anonymousing the authors (e.g. for double-blind review), add "anonymous"
%for enabling thm-restate support, use "thm-restate"
%for enabling a two-column layout for the author/affilation part (only applicable for > 6 authors), use "authorcolumns"
%for producing a PDF according the PDF/A standard, add "pdfa"

%\pdfoutput=1 %uncomment to ensure pdflatex processing (mandatatory e.g. to submit to arXiv)
%\hideLIPIcs  %uncomment to remove references to LIPIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\bibliographystyle{plainurl}% the mandatory bibstyle

\title{Plots of the Paper: Engineering Compact Data Structures for Rank and Select Queries on Bit Vectors} %TODO Please add

%\titlerunning{Dummy short title} %TODO optional, please use if title is longer than one line

\author{Florian Kurpicz}{Karlsruhe Institute of Technology, Germany \and \url{https://kurpicz.org}}{kurpicz@kit.edu}{https://orcid.org/0000-0002-2379-9455}{}%TODO mandatory, please use full name; only 1 author per \author macro; first two parameters are mandatory, other parameters can be empty. Please provide at least the name of the affiliation and the country. The full address is optional. Use additional curly braces to indicate the correct name splitting when the last name consists of multiple name parts.

\authorrunning{F. Kurpicz} %TODO mandatory. First: Use abbreviated first/middle names. Second (only in severe cases): Use first author plus 'et al.'

\Copyright{Florian Kurpicz} %TODO mandatory, please use full first names. LIPIcs license is "CC-BY";  http://creativecommons.org/licenses/by/3.0/

\ccsdesc[500]{Theory of computation~Data structures design and analysis}
% \ccsdesc[100]{\textcolor{red}{Replace ccsdesc macro with valid one}} %TODO mandatory: Please choose ACM 2012 classifications from https://dl.acm.org/ccs/ccs_flat.cfm 

\keywords{rank and select, space-efficient, bit vector, succinct data structures} %TODO mandatory; please add comma-separated list of keywords

\category{} %optional, e.g. invited paper

\relatedversion{} %optional, e.g. full version hosted on arXiv, HAL, or other respository/website
%\relatedversiondetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93]{Classification (e.g. Full Version, Extended Version, Previous Version}{URL to related version} %linktext and cite are optional

\supplement{All implementations presented in this paper and scripts to reproduce our experimental evaluation are available under the GPLv3 license.}%optional, e.g. related research data, source code, ... hosted on a repository like zenodo, figshare, GitHub, ...
\supplementdetails[]{Rank and select data structure implementations}{https://github.com/pasta-toolbox/bit_vector}
\supplementdetails[]{Scripts for reproduction of results}{https://github.com/pasta-toolbox/bit_vector_experiments}
%\supplementdetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93, subcategory={Description, Subcategory}, swhid={Software Heritage Identifier}]{General Classification (e.g. Software, Dataset, Model, ...)}{URL to related version} %linktext, cite, and subcategory are optional

%\funding{(Optional) general funding statement \dots}%optional, to capture a funding statement, which applies to all authors. Please enter author specific funding statements as fifth argument of the \author macro.

%\acknowledgements{I want to thank \dots}%optional

%\nolinenumbers %uncomment to disable line numbering

%Editor-only macros:: begin (do not touch as author)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\EventEditors{John Q. Open and Joan R. Access}
\EventNoEds{2}
\EventLongTitle{42nd Conference on Very Important Topics (CVIT 2016)}
\EventShortTitle{CVIT 2016}
\EventAcronym{CVIT}
\EventYear{2016}
\EventDate{December 24--27, 2016}
\EventLocation{Little Whinging, United Kingdom}
\EventLogo{}
\SeriesVolume{42}
\ArticleNo{23}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{booktabs}
\usepackage{svg}
\usepackage{tikz,pgfplots}

\definecolor{my-dark-red}{RGB}{183, 28, 28}
\definecolor{my-red}{RGB}{244,67,54}
\definecolor{my-pink}{RGB}{233,30,99}
\definecolor{my-purple}{RGB}{156,39,176}
\definecolor{my-deep-puple}{RGB}{103,58,183}
\definecolor{my-indigo}{RGB}{63,81,181}
\definecolor{my-blue}{RGB}{33,150,243}
\definecolor{my-light-blue}{RGB}{3,169,244}
\definecolor{my-cyan}{RGB}{0,188,212}
\definecolor{my-teal}{RGB}{0,150,136}
\definecolor{my-green}{RGB}{76,175,80}
\definecolor{my-light-green}{RGB}{139,195,74}
\definecolor{my-lime}{RGB}{205,220,57}
\definecolor{my-yellow}{RGB}{255,235,59}
\definecolor{my-amber}{RGB}{255,193,7}
\definecolor{my-orange}{RGB}{255,152,0}
\definecolor{my-deep-orange}{RGB}{255,87,34}
\definecolor{my-brown}{RGB}{121,85,72}
\definecolor{my-grey}{RGB}{158,158,158}
\definecolor{my-dark-grey}{RGB}{111,111,111}
\definecolor{my-blue-grey}{RGB}{96,125,139}

\pgfplotscreateplotcyclelist{mycolor}{%
  my-red, every mark/.append style={solid,scale=0.8}, mark=x \\%
  my-blue, every mark/.append style={solid,scale=0.6}, mark=o \\%
  my-light-green, every mark/.append style={solid,scale=0.8}, mark=diamond \\%
  my-purple, every mark/.append style={solid,scale=0.8,rotate=180}, mark=triangle \\%
  my-teal, every mark/.append style={solid,scale=0.65}, mark=square \\%
  my-amber, every mark/.append style={solid,scale=0.8}, mark=star \\%
  my-deep-orange, every mark/.append style={solid,scale=0.8}, mark=triangle \\%
  my-indigo, every mark/.append style={solid,scale=0.8}, mark=+ \\%
  my-orange, every mark/.append style={solid,scale=0.8}, mark=pentagon \\%
  my-brown, every mark/.append style={solid,scale=0.9}, mark=Mercedes star flipped \\%
  %
  my-red, every mark/.append style={solid,scale=0.8}, mark=x, dashed \\%
  my-blue, every mark/.append style={solid,scale=0.6}, mark=o, dashed \\%
  my-light-green, every mark/.append style={solid,scale=0.8}, mark=diamond, dashed \\%
  my-purple, every mark/.append style={solid,scale=0.8,rotate=180}, mark=triangle, dashed \\%
  my-teal, every mark/.append style={solid,scale=0.65}, mark=square, dashed \\%
  my-amber, every mark/.append style={solid,scale=0.8}, mark=star, dashed \\%
  my-deep-orange, every mark/.append style={solid,scale=0.8}, mark=triangle, dashed \\%
  my-indigo, every mark/.append style={solid,scale=0.8}, mark=+, dashed \\%
  my-organge, every mark/.append style={solid,scale=0.8}, mark=pentagon, dashed \\%
  my-brown, every mark/.append style={solid,scale=0.9}, mark=Mercedes star flipped, dashed \\%
  %
  my-red, every mark/.append style={solid,scale=0.8}, mark=x, densely dotted \\%
  my-blue, every mark/.append style={solid,scale=0.6}, mark=o, densely dotted \\%
  my-light-green, every mark/.append style={solid,scale=0.8}, mark=diamond, densely dotted \\%
  my-purple, every mark/.append style={solid,scale=0.8,rotate=180}, mark=triangle, densely dotted \\%
  my-teal, every mark/.append style={solid,scale=0.65}, mark=square, densely dotted \\%
  my-amber, every mark/.append style={solid,scale=0.8}, mark=star, densely dotted \\%
  my-deep-orange, every mark/.append style={solid,scale=0.8}, mark=triangle, densely dotted \\%
  my-indigo, every mark/.append style={solid,scale=0.8}, mark=+, densely dotted \\%
  my-orange, every mark/.append style={solid,scale=0.8}, mark=pentagon, densely dotted \\%
  my-brown, every mark/.append style={solid,scale=0.9}, mark=Mercedes star flipped, densely dotted \\%
}


\pgfplotsset{
  major grid style={thin,dotted,color=my-blue-grey!80!black},
  minor grid style={thin,dotted,color=my-grey},
  ymajorgrids,
  yminorgrids,
  cycle list name={mycolor},
  every axis/.append style={
    line width=0.5pt,
    tick style={
      line cap=round,
      thin,
      major tick length=4pt,
      minor tick length=2pt,
    },
  },
  legend cell align=left,
  legend style={
    /tikz/every even column/.append style={column sep=3mm,black},
    /tikz/every odd column/.append style={black},
  },
  % move title closer
  legend style={font=\small},
  title style={yshift=-2pt},
  % less space on left and right
  enlarge x limits=0.04,
  every tick label/.append style={font=\footnotesize},
  every axis label/.append style={font=\small},
  every axis y label/.append style={yshift=-1ex},
  %
  % Custom Plot Stylrs
  %
  plotSelectQueryTimeAll/.style={
    %%% these are the magic lines to get what you want
    % only show axis lines on left and bottom
    axis lines=left,
    % with the above command arrows are by default shown on the axis lines
    % which we don't want here
    x axis line style={-},
    y axis line style={-},
    % the axis lines should be shifted (like the Tufte style)
    axis line shift=10pt,
    % and we want to show major grid lines for the y axis
    ymajorgrids=true,
    grid=both,
    % the y tick distance showed be increased ...
    % ytick distance=50,
    % ---------------------------------------------------------------------
    width=50.0mm,
    height=50mm,
    ymin=50,
    ymax=375,
  },
  plotRankQueryTimeAll/.style={
    %%% these are the magic lines to get what you want
    % only show axis lines on left and bottom
    axis lines=left,
    % with the above command arrows are by default shown on the axis lines
    % which we don't want here
    x axis line style={-},
    y axis line style={-},
    % the axis lines should be shifted (like the Tufte style)
    axis line shift=10pt,
    % and we want to show major grid lines for the y axis
    ymajorgrids=true,
    grid=both,
    % the y tick distance showed be increased ...
    % ytick distance=50,
    % ---------------------------------------------------------------------
    width=50.0mm,
    height=50.0mm,
    ymin=30,
    ymax=70,
  },
  plotConstructionTimeAll/.style={
    %%% these are the magic lines to get what you want
    % only show axis lines on left and bottom
    axis lines=left,
    % with the above command arrows are by default shown on the axis lines
    % which we don't want here
    x axis line style={-},
    y axis line style={-},
    % the axis lines should be shifted (like the Tufte style)
    axis line shift=10pt,
    % and we want to show major grid lines for the y axis
    ymajorgrids=true,
    xmajorgrids=true,
    grid=both,
    % the y tick distance showed be increased ...
    % ytick distance=50,
    % ---------------------------------------------------------------------
    width=50.0mm,
    height=50.0mm,
    ymin=0,
    ymax=220,
  },
  plotMemoryRequirementsAll/.style={
    %%% these are the magic lines to get what you want
    % only show axis lines on left and bottom
    axis lines=left,
    % with the above command arrows are by default shown on the axis lines
    % which we don't want here
    x axis line style={-},
    y axis line style={-},
    % the axis lines should be shifted (like the Tufte style)
    axis line shift=10pt,
    % and we want to show major grid lines for the y axis
    ymajorgrids=true,
    minor x tick num=1,
    grid=both,
    xlabel near ticks,
    ylabel near ticks,
    % the y tick distance showed be increased ...
    % ytick distance=50,
    % ---------------------------------------------------------------------
    tick align=outside,
    width=50.0mm,
    height=50.0mm,
    ymin=100,
    ymax=450,
  }
}

\begin{document}

\maketitle

% IMPORT-DATA stats results.txt

\begin{table}
  \centering
  \begin{tabular}{lrrrrrr}
    \toprule
    Name & \(1\cdot 10^9\) & \(2\cdot 10^9\) & \(4\cdot 10^9\) & \(8\cdot 10^9\) & \(16\cdot 10^9\) & \(32\cdot 10^9\)\\
    \midrule
%% TABULAR REFORMAT(col 0-100=(precision=2))
%% SELECT algo AS x,
%% (SELECT  100.0 / AVG(bit_size) * (AVG(rank_select_memory_peak) * 8.0) FROM stats s1 WHERE s1.algo=s.algo AND s1.bit_size=1000000000 GROUP BY s1.bit_size),
%% (SELECT  100.0 / AVG(bit_size) * (AVG(rank_select_memory_peak) * 8.0) FROM stats s1 WHERE s1.algo=s.algo AND s1.bit_size=2000000000 GROUP BY s1.bit_size),
%% (SELECT  100.0 / AVG(bit_size) * (AVG(rank_select_memory_peak) * 8.0) FROM stats s1 WHERE s1.algo=s.algo AND s1.bit_size=4000000000 GROUP BY s1.bit_size),
%% (SELECT  100.0 / AVG(bit_size) * (AVG(rank_select_memory_peak) * 8.0) FROM stats s1 WHERE s1.algo=s.algo AND s1.bit_size=8000000000 GROUP BY s1.bit_size),
%% (SELECT  100.0 / AVG(bit_size) * (AVG(rank_select_memory_peak) * 8.0) FROM stats s1 WHERE s1.algo=s.algo AND s1.bit_size=16000000000 GROUP BY s1.bit_size),
%% (SELECT  100.0 / AVG(bit_size) * (AVG(rank_select_memory_peak) * 8.0) FROM stats s1 WHERE s1.algo=s.algo AND s1.bit_size=32000000000 GROUP BY s1.bit_size)
%% FROM stats s
%% WHERE algo NOT LIKE '%flat-one_dont_care-linear_search%' AND algo NOT LIKE '%flat-one_dont_care-binary_search%'
%% GROUP BY s.algo
    cs-poppy &  3.32 &  3.32 &  3.32 &       &       &       \\
    cs-poppy-fs &  3.32 &  3.32 &  3.32 &       &       &       \\
    pasta-poppy &  3.58 &  3.58 &  3.58 &  3.58 &  3.58 &  3.58 \\
    pasta-flat\(_{\texttt{SIMD}}\)&  3.58 &  3.58 &  3.58 &  3.58 &  3.58 &  3.58 \\
    \midrule
    pasta-wide & 10.16 & 10.17 & 10.16 & 10.16 & 10.16 & 10.16 \\
    sdsl-v & 25.00 & 25.00 & 25.00 & 25.00 & 25.00 & 25.00 \\
    sdsl-v5 &  6.25 &  6.25 &  6.25 &  6.25 &  6.25 &  6.25 \\
    \midrule
    sdsl-mcl & 18.51 & 18.52 & 18.53 & 18.54 & 18.55 & 18.56 \\
    simple-select\(_0\) &  8.72 &  8.72 &  8.72 &  8.72 &  8.72 &  8.72 \\
    simple-select\(_1\) &  9.88 &  9.88 &  9.88 &  9.88 &  9.88 &  9.88 \\
    simple-select\(_2\) & 12.21 & 12.20 & 12.20 & 12.20 & 12.20 & 12.20 \\
    simple-select\(_3\) & 16.85 & 16.85 & 16.84 & 16.84 & 16.84 & 16.84 \\
    simple-select\(_h\) & 15.62 & 15.63 & 15.63 & 15.63 & 15.63 & 15.63 \\
    rank9select & 56.25 & 56.25 & 56.25 & 56.25 & 56.25 & 56.25 \\
% END TABULAR SELECT algo AS x, (SELECT  100.0 / AVG(bit_size) * (AVG(rank...)))
    \bottomrule
  \end{tabular}
  \caption{Average additional space in percent used by all evaluated data structures on bit vectors of different sizes over the uniform and adversarial distribution.
    We first list the data structures that can answer rank \emph{and} select queries before listing rank-only data structures that are followed by select-only data structures.}
  \label{tab:space_requirements}
\end{table}

\begin{table}
  \centering
  \begin{tabular}{lrr}
    \toprule
    Name &  slowdown (uniform) & slowdown (adversarial)\\
    \midrule
%% TABULAR REFORMAT(col 0-100=(precision=3))
%% SELECT algo AS x,
%% (SELECT  AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) FROM stats s1 WHERE s1.algo=s.algo AND s1.is_adversarial='false'),
%% (SELECT  AVG((select0_query_time * 1.0) / 100000000 * 1000 * 1000) FROM stats s1 WHERE s1.algo=s.algo AND s1.is_adversarial='false'),
%% (SELECT  1.0 / AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) * AVG((select0_query_time * 1.0) / 100000000 * 1000 * 1000) FROM stats s1 WHERE s1.algo=s.algo AND s1.is_adversarial='false'),
%% (SELECT  AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) FROM stats s1 WHERE s1.algo=s.algo AND s1.is_adversarial='true'),
%% (SELECT  AVG((select0_query_time * 1.0) / 100000000 * 1000 * 1000) FROM stats s1 WHERE s1.algo=s.algo AND s1.is_adversarial='true'),
%% (SELECT  1.0 / AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) * AVG((select0_query_time * 1.0) / 100000000 * 1000 * 1000) FROM stats s1 WHERE s1.algo=s.algo AND s1.is_adversarial='true')
%% FROM stats s
%% WHERE select1_query_time>0 AND select0_query_time>0
%% GROUP BY s.algo
    pasta-poppy & 1.632 & 1.559 \\
    pasta-flat\(_{\texttt{binary}}\) & \textbf{1.526} & \textbf{1.402} \\
    pasta-flat\(_{\texttt{SIMD}}\)  & 1.817 & 1.813 \\
    pasta-flat\(_{\texttt{linear}}\) & 1.651 & 1.604 \\
% END TABULAR SELECT algo AS x, (SELECT  AVG((select1_query_time * 1.0) / 1...))
    \bottomrule
  \end{tabular}
  \caption{Slowdown of \(select_0\) queries compared to \(select_1\) queries, when the ranks of ones are stored for each block. Note that our implementations also support optimized \(select_0\) queries.}
  \label{tab:slowdown_select01}
\end{table}

\begin{figure}
\begin{center}
\begin{tikzpicture}
  \begin{axis}[
    plotRankQueryTimeAll,
    legend columns=4,
    legend to name={leg:rank_query_times},
    title={fill count 10\,\%},
    ylabel={\begin{tabular}{c}uniform distribution\\time (ns / \textbf{rank} query)\end{tabular}},
    xlabel near ticks,
    ylabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo|title) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((rank1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, algo AS title, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=10 AND is_adversarial='false' AND rank1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,45.1) (1.0,47.56) (2.0,50.1) };
    \addlegendentry{cs-poppy};
    \addplot coordinates { (0.0,45.26) (1.0,47.88) (2.0,50.38) };
    \addlegendentry{cs-poppy-fs};
    \addplot coordinates { (0.0,42.94) (1.0,43.92) (2.0,46.37) (3.0,49.63) (4.0,55.09) (5.0,66.16) };
    \addlegendentry{pasta-poppy};
    \addplot coordinates { (0.0,42.6) (1.0,43.83) (2.0,46.47) (3.0,49.77) (4.0,55.15) (5.0,65.72) };
    \addlegendentry{pasta-flat\(_{\texttt{SIMD}}\)};
    \addplot coordinates { (0.0,43.49) (1.0,44.91) (2.0,46.27) (3.0,47.6) (4.0,49.08) (5.0,53.85) };
    \addlegendentry{pasta-wide};
    \addplot coordinates { (0.0,30.22) (1.0,30.16) (2.0,32.01) (3.0,32.4) (4.0,40.02) (5.0,52.62) };
    \addlegendentry{sdsl-v};
    \addplot coordinates { (0.0,49.47) (1.0,52.11) (2.0,54.26) (3.0,57.11) (4.0,66.81) (5.0,77.8) };
    \addlegendentry{sdsl-v5};
    \addplot coordinates { (0.0,30.98) (1.0,31.81) (2.0,32.44) (3.0,33.98) (4.0,41.57) (5.0,54.3) };
    \addlegendentry{rank9select};

  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotRankQueryTimeAll,
    title={fill count 50\,\%},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2, bit_size / 1000000000) AS x, AVG((rank1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=50 AND is_adversarial='false' AND rank1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,46.38) (1.0,48.08) (2.0,50.39) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,46.31) (1.0,48.07) (2.0,50.51) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,42.69) (1.0,43.94) (2.0,46.4) (3.0,48.85) (4.0,54.1) (5.0,65.76) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,42.93) (1.0,43.93) (2.0,46.43) (3.0,49.63) (4.0,53.87) (5.0,65.08) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,44.31) (1.0,45.2) (2.0,46.02) (3.0,47.33) (4.0,48.03) (5.0,53.28) };
    \addlegendentry{algo=pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,30.4) (1.0,29.85) (2.0,31.95) (3.0,33.33) (4.0,38.6) (5.0,52.22) };
    \addlegendentry{algo=sdsl-rank-v};
    \addplot coordinates { (0.0,49.67) (1.0,52.48) (2.0,53.87) (3.0,57.17) (4.0,65.86) (5.0,77.57) };
    \addlegendentry{algo=sdsl-rank-v5};
    \addplot coordinates { (0.0,31.24) (1.0,32.0) (2.0,32.39) (3.0,34.14) (4.0,40.84) (5.0,53.86) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotRankQueryTimeAll,
    title={fill count 90\,\%},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((rank1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=90 AND is_adversarial='false' AND rank1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,46.34) (1.0,47.87) (2.0,50.94) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,46.39) (1.0,47.92) (2.0,50.88) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,42.59) (1.0,44.02) (2.0,46.84) (3.0,50.59) (4.0,55.14) (5.0,64.28) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,42.51) (1.0,43.91) (2.0,47.09) (3.0,50.6) (4.0,55.14) (5.0,63.66) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,43.47) (1.0,45.12) (2.0,46.24) (3.0,47.36) (4.0,47.92) (5.0,53.67) };
    \addlegendentry{algo=pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,29.56) (1.0,29.7) (2.0,30.48) (3.0,31.72) (4.0,39.46) (5.0,51.93) };
    \addlegendentry{algo=sdsl-rank-v};
    \addplot coordinates { (0.0,50.01) (1.0,52.03) (2.0,53.99) (3.0,56.54) (4.0,65.35) (5.0,77.84) };
    \addlegendentry{algo=sdsl-rank-v5};
    \addplot coordinates { (0.0,30.93) (1.0,31.87) (2.0,32.37) (3.0,33.8) (4.0,40.67) (5.0,54.21) };
    \addlegendentry{algo=sux-rank9select};
    \legend{}
  \end{axis}
\end{tikzpicture}
\begin{tikzpicture}
  \begin{axis}[
    plotRankQueryTimeAll,
    xlabel={bits (\(n/10^9\))},
    ylabel={\begin{tabular}{c}adversarial distribution\\time (ns / \textbf{rank} query)\end{tabular}},
    xlabel near ticks,
    ylabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((rank1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=10 AND is_adversarial='true' AND rank1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,44.95) (1.0,47.75) (2.0,50.33) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,45.03) (1.0,47.96) (2.0,50.5) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,42.75) (1.0,43.94) (2.0,46.18) (3.0,49.01) (4.0,54.19) (5.0,65.85) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,42.76) (1.0,43.61) (2.0,46.76) (3.0,49.3) (4.0,53.94) (5.0,64.93) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,43.19) (1.0,45.1) (2.0,46.37) (3.0,46.68) (4.0,48.23) (5.0,53.61) };
    \addlegendentry{algo=pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,29.94) (1.0,31.47) (2.0,30.91) (3.0,32.48) (4.0,38.21) (5.0,52.36) };
    \addlegendentry{algo=sdsl-rank-v};
    \addplot coordinates { (0.0,50.93) (1.0,52.47) (2.0,54.42) (3.0,56.44) (4.0,65.18) (5.0,77.6) };
    \addlegendentry{algo=sdsl-rank-v5};
    \addplot coordinates { (0.0,31.86) (1.0,31.95) (2.0,32.62) (3.0,33.77) (4.0,40.64) (5.0,53.87) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotRankQueryTimeAll,
    xlabel={bits (\(n/10^9\))},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2, bit_size / 1000000000) AS x, AVG((rank1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=50 AND is_adversarial='true' AND rank1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,44.74) (1.0,47.65) (2.0,50.75) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,44.69) (1.0,47.68) (2.0,50.72) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,42.67) (1.0,43.93) (2.0,46.79) (3.0,48.88) (4.0,53.85) (5.0,66.23) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,42.6) (1.0,43.85) (2.0,46.82) (3.0,49.07) (4.0,53.9) (5.0,65.44) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,42.94) (1.0,45.13) (2.0,46.24) (3.0,46.85) (4.0,47.72) (5.0,54.06) };
    \addlegendentry{algo=pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,29.35) (1.0,31.54) (2.0,31.92) (3.0,33.06) (4.0,39.19) (5.0,52.02) };
    \addlegendentry{algo=sdsl-rank-v};
    \addplot coordinates { (0.0,48.8) (1.0,52.63) (2.0,54.33) (3.0,56.57) (4.0,65.6) (5.0,77.96) };
    \addlegendentry{algo=sdsl-rank-v5};
    \addplot coordinates { (0.0,30.99) (1.0,32.12) (2.0,32.61) (3.0,33.62) (4.0,40.97) (5.0,54.06) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotRankQueryTimeAll,
    xlabel={bits (\(n/10^9\))},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo|title) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((rank1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, algo as title, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=90 AND is_adversarial='true' AND rank1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,44.71) (1.0,47.98) (2.0,50.45) };
    \addlegendentry{efficient-poppy-rank-select};
    \addplot coordinates { (0.0,44.65) (1.0,47.93) (2.0,50.53) };
    \addlegendentry{efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,42.49) (1.0,44.1) (2.0,46.5) (3.0,50.48) (4.0,55.53) (5.0,64.17) };
    \addlegendentry{pasta-popcount};
    \addplot coordinates { (0.0,42.43) (1.0,44.21) (2.0,46.74) (3.0,50.58) (4.0,55.7) (5.0,63.92) };
    \addlegendentry{pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,43.15) (1.0,45.37) (2.0,46.21) (3.0,47.4) (4.0,48.2) (5.0,53.45) };
    \addlegendentry{pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,28.95) (1.0,30.69) (2.0,30.73) (3.0,33.19) (4.0,39.41) (5.0,52.03) };
    \addlegendentry{sdsl-rank-v};
    \addplot coordinates { (0.0,50.13) (1.0,52.49) (2.0,54.0) (3.0,56.75) (4.0,65.36) (5.0,77.71) };
    \addlegendentry{sdsl-rank-v5};
    \addplot coordinates { (0.0,31.07) (1.0,32.0) (2.0,32.48) (3.0,33.81) (4.0,41.28) (5.0,54.13) };
    \addlegendentry{sux-rank9select};
    \legend{}
  \end{axis}
\end{tikzpicture}
\ref{leg:rank_query_times}
\caption{Average rank query time in nanoseconds on all tested inputs.}
\label{fig:rank_query_times}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\begin{tikzpicture}
  \begin{axis}[
    plotSelectQueryTimeAll,
    legend columns=4,
    legend to name={leg:select_query_times},
    title={fill count 10\,\%},
    ylabel={\begin{tabular}{c}uniform distribution\\time (ns / \textbf{select} query)\end{tabular}},
    xlabel near ticks,
    ylabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo|title) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, algo AS title, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=10 AND is_adversarial='false' AND select1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,153.14) (1.0,157.63) (2.0,172.7) };
    \addlegendentry{cs-poppy};
    \addplot coordinates { (0.0,153.16) (1.0,157.66) (2.0,174.21) };
    \addlegendentry{cs-poppy-fs};
    \addplot coordinates { (0.0,139.15) (1.0,145.89) (2.0,163.17) (3.0,194.18) (4.0,235.19) (5.0,315.91) };
    \addlegendentry{pasta-poppy};
    \addplot coordinates { (0.0,131.01) (1.0,139.59) (2.0,167.48) (3.0,209.81) (4.0,245.45) (5.0,268.77) };
    \addlegendentry{pasta-flat\(_\texttt{SIMD}\)};
    \addplot coordinates { (0.0,166.1) (1.0,215.36) (2.0,268.58) (3.0,338.03) (4.0,409.15) (5.0,446.97) };
    \addlegendentry{sdsl-mcl};
    \addplot coordinates { (0.0,169.06) (1.0,199.74) (2.0,222.82) (3.0,254.36) (4.0,292.72) (5.0,309.72) };
    \addlegendentry{simple-select\(_0\)};
    \addplot coordinates { (0.0,105.77) (1.0,131.56) (2.0,152.83) (3.0,166.99) (4.0,192.32) (5.0,209.36) };
    \addlegendentry{simple-select\(_1\)};
    \addplot coordinates { (0.0,87.99) (1.0,105.61) (2.0,118.45) (3.0,126.18) (4.0,140.99) (5.0,155.09) };
    \addlegendentry{simple-select\(_2\)};
    \addplot coordinates { (0.0,93.72) (1.0,106.92) (2.0,115.27) (3.0,121.06) (4.0,133.47) (5.0,147.39) };
    \addlegendentry{simple-select\(_3\)};
    \addplot coordinates { (0.0,118.34) (1.0,151.3) (2.0,178.49) (3.0,198.51) (4.0,228.6) (5.0,250.77) };
    \addlegendentry{simple-select\(_h\)};
    \addplot coordinates { (0.0,169.03) (1.0,194.94) (2.0,226.61) (3.0,257.92) (4.0,287.59) (5.0,318.8) };
    \addlegendentry{rank9select};

  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotSelectQueryTimeAll,
    title={fill count 50\,\%},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2, bit_size / 1000000000) AS x, AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=50 AND is_adversarial='false' AND select1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,128.66) (1.0,137.18) (2.0,155.56) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,128.76) (1.0,136.57) (2.0,155.58) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,133.0) (1.0,146.96) (2.0,167.73) (3.0,208.46) (4.0,244.45) (5.0,287.39) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,107.38) (1.0,120.58) (2.0,141.96) (3.0,163.26) (4.0,206.73) (5.0,243.72) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,271.85) (1.0,329.67) (2.0,365.0) (3.0,406.64) (4.0,444.99) (5.0,478.83) };
    \addlegendentry{algo=sdsl-select-mcl};
    \addplot coordinates { (0.0,170.15) (1.0,205.98) (2.0,234.37) (3.0,269.77) (4.0,306.67) (5.0,328.9) };
    \addlegendentry{algo=sux-SimpleSelect-0};
    \addplot coordinates { (0.0,148.92) (1.0,181.9) (2.0,206.97) (3.0,235.45) (4.0,268.24) (5.0,289.66) };
    \addlegendentry{algo=sux-SimpleSelect-1};
    \addplot coordinates { (0.0,85.68) (1.0,105.52) (2.0,123.89) (3.0,136.98) (4.0,151.06) (5.0,167.66) };
    \addlegendentry{algo=sux-SimpleSelect-2};
    \addplot coordinates { (0.0,92.22) (1.0,110.15) (2.0,120.13) (3.0,127.44) (4.0,139.16) (5.0,155.24) };
    \addlegendentry{algo=sux-SimpleSelect-3};
    \addplot coordinates { (0.0,101.5) (1.0,113.17) (2.0,118.36) (3.0,123.46) (4.0,133.35) (5.0,148.96) };
    \addlegendentry{algo=sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,205.17) (1.0,231.18) (2.0,246.41) (3.0,261.23) (4.0,274.54) (5.0,304.51) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotSelectQueryTimeAll,
    title={fill count 90\,\%},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=90 AND is_adversarial='false' AND select1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,119.05) (1.0,136.82) (2.0,164.32) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,118.89) (1.0,137.64) (2.0,163.63) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,121.73) (1.0,138.53) (2.0,175.26) (3.0,216.56) (4.0,243.83) (5.0,286.83) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,101.26) (1.0,117.81) (2.0,144.27) (3.0,194.66) (4.0,227.34) (5.0,253.52) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,335.04) (1.0,379.97) (2.0,406.45) (3.0,431.08) (4.0,470.23) (5.0,521.68) };
    \addlegendentry{algo=sdsl-select-mcl};
    \addplot coordinates { (0.0,172.34) (1.0,199.41) (2.0,220.14) (3.0,249.48) (4.0,279.79) (5.0,303.37) };
    \addlegendentry{algo=sux-SimpleSelect-0};
    \addplot coordinates { (0.0,96.59) (1.0,121.28) (2.0,135.23) (3.0,145.44) (4.0,156.47) (5.0,174.28) };
    \addlegendentry{algo=sux-SimpleSelect-1};
    \addplot coordinates { (0.0,95.44) (1.0,109.7) (2.0,120.56) (3.0,127.24) (4.0,138.67) (5.0,157.0) };
    \addlegendentry{algo=sux-SimpleSelect-2};
    \addplot coordinates { (0.0,100.67) (1.0,113.4) (2.0,120.69) (3.0,125.39) (4.0,135.38) (5.0,153.5) };
    \addlegendentry{algo=sux-SimpleSelect-3};
    \addplot coordinates { (0.0,107.38) (1.0,115.7) (2.0,119.6) (3.0,123.25) (4.0,132.17) (5.0,152.33) };
    \addlegendentry{algo=sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,223.83) (1.0,243.74) (2.0,253.0) (3.0,264.44) (4.0,274.6) (5.0,311.05) };
    \addlegendentry{algo=sux-rank9select};
    \legend{}
  \end{axis}
\end{tikzpicture}
\begin{tikzpicture}
  \begin{axis}[
    plotSelectQueryTimeAll,
    xlabel={bits (\(n/10^9\))},
    ylabel={\begin{tabular}{c}adversarial distribution\\time (ns / \textbf{select} query)\end{tabular}},
    xlabel near ticks,
    ylabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=10 AND is_adversarial='true' AND select1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,98.18) (1.0,114.46) (2.0,130.55) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,98.63) (1.0,115.67) (2.0,131.37) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,71.36) (1.0,104.54) (2.0,127.54) (3.0,156.93) (4.0,190.17) (5.0,265.06) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,69.07) (1.0,96.49) (2.0,114.29) (3.0,128.45) (4.0,153.28) (5.0,184.03) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,177.64) (1.0,246.64) (2.0,315.65) (3.0,377.5) (4.0,404.54) (5.0,425.76) };
    \addlegendentry{algo=sdsl-select-mcl};
    \addplot coordinates { (0.0,75.35) (1.0,101.36) (2.0,121.39) (3.0,132.68) (4.0,139.39) (5.0,143.27) };
    \addlegendentry{algo=sux-SimpleSelect-0};
    \addplot coordinates { (0.0,69.86) (1.0,97.79) (2.0,116.1) (3.0,126.62) (4.0,132.51) (5.0,135.68) };
    \addlegendentry{algo=sux-SimpleSelect-1};
    \addplot coordinates { (0.0,71.39) (1.0,94.21) (2.0,110.12) (3.0,117.72) (4.0,123.43) (5.0,125.84) };
    \addlegendentry{algo=sux-SimpleSelect-2};
    \addplot coordinates { (0.0,77.38) (1.0,94.79) (2.0,107.83) (3.0,113.74) (4.0,118.19) (5.0,120.4) };
    \addlegendentry{algo=sux-SimpleSelect-3};
    \addplot coordinates { (0.0,93.69) (1.0,117.54) (2.0,134.33) (3.0,142.91) (4.0,149.33) (5.0,152.52) };
    \addlegendentry{algo=sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,67.95) (1.0,125.17) (2.0,176.75) (3.0,213.98) (4.0,236.38) (5.0,248.4) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotSelectQueryTimeAll,
    xlabel={bits (\(n/10^9\))},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2, bit_size / 1000000000) AS x, AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=50 AND is_adversarial='true' AND select1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,108.11) (1.0,118.98) (2.0,143.2) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,108.16) (1.0,118.67) (2.0,143.04) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,99.7) (1.0,119.75) (2.0,147.52) (3.0,186.35) (4.0,231.43) (5.0,298.94) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,91.99) (1.0,102.09) (2.0,123.13) (3.0,148.73) (4.0,189.19) (5.0,234.07) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,293.46) (1.0,363.11) (2.0,390.55) (3.0,415.43) (4.0,443.37) (5.0,483.76) };
    \addlegendentry{algo=sdsl-select-mcl};
    \addplot coordinates { (0.0,129.14) (1.0,168.24) (2.0,195.55) (3.0,213.63) (4.0,239.93) (5.0,270.06) };
    \addlegendentry{algo=sux-SimpleSelect-0};
    \addplot coordinates { (0.0,75.05) (1.0,96.81) (2.0,120.63) (3.0,132.33) (4.0,141.83) (5.0,153.72) };
    \addlegendentry{algo=sux-SimpleSelect-1};
    \addplot coordinates { (0.0,75.63) (1.0,95.39) (2.0,111.74) (3.0,119.73) (4.0,127.29) (5.0,138.89) };
    \addlegendentry{algo=sux-SimpleSelect-2};
    \addplot coordinates { (0.0,78.33) (1.0,102.63) (2.0,115.08) (3.0,120.27) (4.0,125.85) (5.0,135.93) };
    \addlegendentry{algo=sux-SimpleSelect-3};
    \addplot coordinates { (0.0,100.33) (1.0,112.55) (2.0,120.13) (3.0,123.41) (4.0,127.55) (5.0,137.81) };
    \addlegendentry{algo=sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,189.31) (1.0,226.53) (2.0,245.22) (3.0,256.21) (4.0,262.72) (5.0,278.07) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{axis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{axis}[
    plotSelectQueryTimeAll,
    xlabel={bits (\(n/10^9\))},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo|title) SELECT LOG(2,bit_size / 1000000000) AS x, AVG((select1_query_time * 1.0) / 100000000 * 1000 * 1000) AS y, algo as title, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=90 AND is_adversarial='true' AND select1_query_time>0 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,111.04) (1.0,134.93) (2.0,162.35) };
    \addlegendentry{efficient-poppy-rank-select};
    \addplot coordinates { (0.0,112.68) (1.0,135.26) (2.0,160.73) };
    \addlegendentry{efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,111.69) (1.0,134.67) (2.0,167.16) (3.0,212.58) (4.0,243.41) (5.0,289.18) };
    \addlegendentry{pasta-popcount};
    \addplot coordinates { (0.0,96.58) (1.0,115.05) (2.0,140.03) (3.0,190.56) (4.0,227.74) (5.0,251.77) };
    \addlegendentry{pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,348.99) (1.0,381.21) (2.0,404.71) (3.0,433.1) (4.0,471.61) (5.0,522.83) };
    \addlegendentry{sdsl-select-mcl};
    \addplot coordinates { (0.0,161.55) (1.0,192.03) (2.0,209.07) (3.0,233.51) (4.0,265.63) (5.0,289.44) };
    \addlegendentry{sux-SimpleSelect-0};
    \addplot coordinates { (0.0,91.32) (1.0,117.59) (2.0,130.54) (3.0,139.65) (4.0,150.26) (5.0,165.6) };
    \addlegendentry{sux-SimpleSelect-1};
    \addplot coordinates { (0.0,93.81) (1.0,109.63) (2.0,118.79) (3.0,126.24) (4.0,136.34) (5.0,153.14) };
    \addlegendentry{sux-SimpleSelect-2};
    \addplot coordinates { (0.0,98.6) (1.0,113.77) (2.0,119.61) (3.0,124.83) (4.0,133.6) (5.0,150.33) };
    \addlegendentry{sux-SimpleSelect-3};
    \addplot coordinates { (0.0,106.18) (1.0,114.65) (2.0,118.81) (3.0,122.18) (4.0,130.22) (5.0,148.31) };
    \addlegendentry{sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,220.23) (1.0,243.89) (2.0,252.01) (3.0,263.14) (4.0,272.9) (5.0,304.94) };
    \addlegendentry{sux-rank9select};
    \legend{}
  \end{axis}
\end{tikzpicture}

\ref{leg:select_query_times}
\caption{Average rank query time in nanoseconds on all tested inputs.}
\label{fig:select_query_times}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\begin{tikzpicture}
  \begin{semilogyaxis}[
    plotConstructionTimeAll,
    legend columns=4,
    legend to name={leg:construction_times},
    title={fill count 10\,\%},
    xlabel={bits (\(n/10^9\))},
    ylabel={construction time (s)},
    ylabel near ticks,
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo|title) SELECT LOG(2,bit_size / 1000000000) AS x, AVG(rank_select_construction_time) / 1000.0 AS y, algo as title, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=10 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,0.8605) (1.0,1.70367) (2.0,3.43183) };
    \addlegendentry{cs-poppy};
    \addplot coordinates { (0.0,0.860667) (1.0,1.70433) (2.0,3.4275) };
    \addlegendentry{cs-poppy-fs};
    \addplot coordinates { (0.0,0.0113333) (1.0,0.0205) (2.0,0.039) (3.0,0.0763333) (4.0,0.151833) (5.0,0.297167) };
    \addlegendentry{pasta-poppy};
    \addplot coordinates { (0.0,0.0109167) (1.0,0.0195455) (2.0,0.0371818) (3.0,0.0735) (4.0,0.154833) (5.0,0.303833) };
    \addlegendentry{pasta-flat\(_{\texttt{SIMD}}\)};
    \addplot coordinates { (0.0,0.01475) (1.0,0.029) (2.0,0.0565455) (3.0,0.111167) (4.0,0.231167) (5.0,0.458) };
    \addlegendentry{pasta-wide};
    \addplot coordinates { (0.0,0.0206667) (1.0,0.0408333) (2.0,0.0853333) (3.0,0.172) (4.0,0.336167) (5.0,0.665333) };
    \addlegendentry{sdsl-v};
    \addplot coordinates { (0.0,0.0201667) (1.0,0.0401667) (2.0,0.0841667) (3.0,0.166) (4.0,0.3395) (5.0,0.652) };
    \addlegendentry{sdsl-v5};
    \addplot coordinates { (0.0,0.108167) (1.0,0.214833) (2.0,0.4325) (3.0,0.858) (4.0,1.71633) (5.0,3.35433) };
    \addlegendentry{sdsl-mcl};
    \addplot coordinates { (0.0,2.62983) (1.0,5.2315) (2.0,10.4632) (3.0,20.8893) (4.0,42.4682) (5.0,82.3925) };
    \addlegendentry{simple-select\(_0\)};
    \addplot coordinates { (0.0,2.63667) (1.0,5.24667) (2.0,10.488) (3.0,20.9327) (4.0,42.556) (5.0,82.4727) };
    \addlegendentry{simple-select\(_1\)};
    \addplot coordinates { (0.0,2.66983) (1.0,5.267) (2.0,10.5277) (3.0,21.0142) (4.0,42.797) (5.0,82.7608) };
    \addlegendentry{simple-select\(_2\)};
    \addplot coordinates { (0.0,2.65433) (1.0,5.278) (2.0,10.5507) (3.0,21.0663) (4.0,42.8958) (5.0,82.9405) };
    \addlegendentry{simple-select\(_3\)};
    \addplot coordinates { (0.0,1.908) (1.0,3.79) (2.0,7.574) (3.0,15.0853) (4.0,30.7202) (5.0,59.4232) };
    \addlegendentry{simple-select\(_h\)};
    \addplot coordinates { (0.0,1.5805) (1.0,3.1275) (2.0,6.2565) (3.0,12.5247) (4.0,25.4597) (5.0,49.4518) };
    \addlegendentry{rank9select};
  \end{semilogyaxis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{semilogyaxis}[
    plotConstructionTimeAll,
    title={fill count 50\,\%},
    xlabel={bits (\(n/10^9\))},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2,bit_size / 1000000000) AS x, AVG(rank_select_construction_time) / 1000.0 AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=50 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,1.859) (1.0,3.61583) (2.0,7.30917) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,1.858) (1.0,3.634) (2.0,7.30933) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,0.0115833) (1.0,0.0205) (2.0,0.03875) (3.0,0.0736667) (4.0,0.145) (5.0,0.29) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,0.0107) (1.0,0.0195833) (2.0,0.0373) (3.0,0.0726667) (4.0,0.143333) (5.0,0.285667) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,0.0152) (1.0,0.0286667) (2.0,0.0567) (3.0,0.106333) (4.0,0.218) (5.0,0.430667) };
    \addlegendentry{algo=pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,0.0198333) (1.0,0.0413333) (2.0,0.0831667) (3.0,0.1685) (4.0,0.3305) (5.0,0.6745) };
    \addlegendentry{algo=sdsl-rank-v};
    \addplot coordinates { (0.0,0.017) (1.0,0.0358333) (2.0,0.0713333) (3.0,0.144833) (4.0,0.294) (5.0,0.585833) };
    \addlegendentry{algo=sdsl-rank-v5};
    \addplot coordinates { (0.0,0.473833) (1.0,0.962) (2.0,1.91433) (3.0,3.83667) (4.0,7.805) (5.0,15.5807) };
    \addlegendentry{algo=sdsl-select-mcl};
    \addplot coordinates { (0.0,6.3235) (1.0,12.5693) (2.0,24.994) (3.0,51.4102) (4.0,103.457) (5.0,201.3) };
    \addlegendentry{algo=sux-SimpleSelect-0};
    \addplot coordinates { (0.0,6.33417) (1.0,12.5987) (2.0,25.0438) (3.0,51.3912) (4.0,103.437) (5.0,201.203) };
    \addlegendentry{algo=sux-SimpleSelect-1};
    \addplot coordinates { (0.0,6.33133) (1.0,12.6035) (2.0,25.0648) (3.0,51.4627) (4.0,103.5885) (5.0,201.298) };
    \addlegendentry{algo=sux-SimpleSelect-2};
    \addplot coordinates { (0.0,6.3485) (1.0,12.6223) (2.0,25.1068) (3.0,51.5338) (4.0,103.9775) (5.0,201.673) };
    \addlegendentry{algo=sux-SimpleSelect-3};
    \addplot coordinates { (0.0,4.41433) (1.0,8.774) (2.0,17.4572) (3.0,35.7767) (4.0,72.2143) (5.0,140.4195) };
    \addlegendentry{algo=sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,3.83767) (1.0,7.621) (2.0,15.1533) (3.0,31.1197) (4.0,62.7458) (5.0,122.036) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{semilogyaxis}
\end{tikzpicture}
\hspace{-.5cm}
\begin{tikzpicture}
  \begin{semilogyaxis}[
    plotConstructionTimeAll,
    title={fill count 90\,\%},
    xlabel={bits (\(n/10^9\))},
    y tick style={draw=none},
    yticklabel={\empty},
    y axis line style={draw=none},
    xlabel near ticks,
    xtick={0,1,2,3,4,5},
    xticklabels={1,2,4,8,16,32},
    ]

    %% MULTIPLOT(algo) SELECT LOG(2,bit_size / 1000000000) AS x, AVG(rank_select_construction_time) / 1000.0 AS y, MULTIPLOT
    %% FROM stats
    %% WHERE fill_percentage=90 AND algo NOT LIKE '%flat-one_dont_care-binary_search%' AND algo NOT LIKE '%flat-one_dont_care-linear_search%'
    %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
    \addplot coordinates { (0.0,0.813667) (1.0,1.611) (2.0,3.26533) };
    \addlegendentry{algo=efficient-poppy-rank-select};
    \addplot coordinates { (0.0,0.8195) (1.0,1.61317) (2.0,3.26517) };
    \addlegendentry{algo=efficient-poppy-rank-select-improved};
    \addplot coordinates { (0.0,0.01125) (1.0,0.0205) (2.0,0.03925) (3.0,0.0738333) (4.0,0.147333) (5.0,0.290833) };
    \addlegendentry{algo=pasta-popcount};
    \addplot coordinates { (0.0,0.0107273) (1.0,0.01975) (2.0,0.0371818) (3.0,0.0731667) (4.0,0.146167) (5.0,0.287167) };
    \addlegendentry{algo=pasta-popcount-flat-one\_dont\_care-intrinsics};
    \addplot coordinates { (0.0,0.0149091) (1.0,0.028) (2.0,0.0558182) (3.0,0.103167) (4.0,0.207167) (5.0,0.402833) };
    \addlegendentry{algo=pasta-popcount-wide-one\_dont\_care-linear\_search};
    \addplot coordinates { (0.0,0.0196667) (1.0,0.0421667) (2.0,0.0843333) (3.0,0.165667) (4.0,0.329833) (5.0,0.6755) };
    \addlegendentry{algo=sdsl-rank-v};
    \addplot coordinates { (0.0,0.0168333) (1.0,0.0353333) (2.0,0.0716667) (3.0,0.145167) (4.0,0.293667) (5.0,0.585667) };
    \addlegendentry{algo=sdsl-rank-v5};
    \addplot coordinates { (0.0,0.980167) (1.0,1.98433) (2.0,3.9495) (3.0,7.94133) (4.0,16.0178) (5.0,31.9347) };
    \addlegendentry{algo=sdsl-select-mcl};
    \addplot coordinates { (0.0,3.37067) (1.0,6.82433) (2.0,13.5457) (3.0,27.3228) (4.0,54.8843) (5.0,109.601) };
    \addlegendentry{algo=sux-SimpleSelect-0};
    \addplot coordinates { (0.0,3.373) (1.0,6.83383) (2.0,13.579) (3.0,27.3658) (4.0,54.901) (5.0,109.68) };
    \addlegendentry{algo=sux-SimpleSelect-1};
    \addplot coordinates { (0.0,3.38433) (1.0,6.85467) (2.0,13.6012) (3.0,27.4715) (4.0,55.0658) (5.0,110.025) };
    \addlegendentry{algo=sux-SimpleSelect-2};
    \addplot coordinates { (0.0,3.40367) (1.0,6.8905) (2.0,13.6853) (3.0,27.5988) (4.0,55.4285) (5.0,110.768) };
    \addlegendentry{algo=sux-SimpleSelect-3};
    \addplot coordinates { (0.0,2.38633) (1.0,4.82917) (2.0,9.5785) (3.0,19.3383) (4.0,38.839) (5.0,77.7155) };
    \addlegendentry{algo=sux-SimpleSelectHalf};
    \addplot coordinates { (0.0,2.089) (1.0,4.21967) (2.0,8.38717) (3.0,16.9157) (4.0,33.962) (5.0,67.8517) };
    \addlegendentry{algo=sux-rank9select};
    \legend{};
  \end{semilogyaxis}
\end{tikzpicture}
\ref{leg:construction_times}
\end{center}
\caption{Average construction time in seconds over all inputs.}
\label{fig:construction_time}
\end{figure}

\end{document}
